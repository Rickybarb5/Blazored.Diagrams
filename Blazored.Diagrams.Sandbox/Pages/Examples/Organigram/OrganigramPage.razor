@page "/organogram-example"
@using Blazored.Diagrams.Options.Behaviours
<DiagramContainer DiagramService="Service"></DiagramContainer>

@code {

    [Inject] public IDiagramService Service { get; set; } = null!;

    protected override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            Service.Behaviours.GetBehaviourOptions<DrawLinkBehaviourOptions>().LinkType =typeof(OrthogonalLink);

            List<JobPerson> people =
            [
                new JobPerson("Mark - CEO", 1),
                new JobPerson("Mark - COO",2),
                new JobPerson("Alex - CFO",2),
                new JobPerson("Henry - CTO",2 ),
                new JobPerson("Samantha - Project Manager",4),
                new JobPerson("Brody - Product Owner - Project X",3),
                new JobPerson("Richard - Product Owner - Project Y",3),
                new JobPerson("Developer",5),
                new JobPerson("Developer",5),
                new JobPerson("Developer",5),
                new JobPerson( "Developer",5),
            ];
            
            foreach (var person in people)
            {
                var node = new OrganigramNode { Job = person.Title };
                var port = new Port
                {
                    Alignment = PortAlignment.Bottom,
                    Justification = PortJustification.Center,
                };
                var port2 = new Port
                {
                    Alignment = PortAlignment.Top,
                    Justification = PortJustification.Center,
                };
                
                Service.Add
                    .Node(node)
                    .PortTo(node, port)
                    .PortTo(node, port2);
            }
        }

        return base.OnAfterRenderAsync(firstRender);
    }

    private record JobPerson(string Title, int Level);

}